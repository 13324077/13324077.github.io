---
layout: post
title: 完整机器学习项目实例
date: 2017-09-16 22:23:06 +08:00
category: 机器学习
keywords: python, ML
tags: 机器学习
---

* content
{:toc}

以下通过一个完整的机器学习项目的学习，掌握构建一个机器学习系统的所需要的步骤，大体有：

- 总体对机器学习系统有一个了解

- 获取数据

- 可视化数据，对数据分布有一个简单的了解

- 准备数据用于机器学习算法

- 选择一个模型，并训练

- 修正模型

- 展示实现方案

- 启动，监视和维护构建的机器学习系统


# 实际数据处理

对于机器学习人员来说，最好的方法是通过现实世界中的实际数据进行机器学习的实验，这个可以更好的理解机器学习原理和实际用法。

有上千种数据集选择，涵盖大多数领域，以下是一些获取数据的地方

- **流行的开源数据库**

 1) UC Irvine Machine Learning Repository

 2) Kaggle datasets

 3) Amazon's AWS datasets


- 综合门户网站

 1) http://dataportals.org/

 2) http://opendatamonitor.eu/

 3) http://quandl.com/


- 其他流行开源数据库

 1) Wikipedia’s list of Machine Learning datasets

 2) Quora.com question

 3)Datasets subreddit

本文选择加利福尼亚房价数据集（从StatLib数据库上下载）作为机器学习训练的输入数据。

![ml_project_califorina_housing_prices](/images/ml/ml_project_califorina_housing_prices.png)

# 总体概述

以房产公司为例，

第一个任务：

根据加利福尼亚的**人口调查数据**对加利福尼亚的房价**构建模型**

人口调查数据是对加利福尼亚的各个街区群(每个街区600～3000人)的人口，中位数收入，中位数房价等进行度量。

然后从这些数据中学习模型，能够对各个街区群的中位数房价进行预测。



## 需求确认

首先，确认下需求，构建模型不是最终目标， 需要确认构建的模型如何使用，以及希望从构建的模型中得到怎样的结果。

明确需求非常重要，将确定如何对模型建模，选择什么算法，以及使用什么性能度量方法对模型进行评估等等。

然后，确认下当前的处理方案是什么？以及当前方案的优缺点，因为当前的处理方案可以作为自己设计方案的参考。


## 算法选择

然后，准备设计自己的系统

选择算法： 监督算法，非监督算法，还是增强学习算法？

任务类型：分类任务，回归任务，还是其他？

使用batch learning还是online learning techniques？


因为给定的数据是待标签的训练数据，因此是**监督学习任务**，

因为需要预测一个数值，因此是一个**回归任务**，

因为给定的数据集中每个实例包括多个特征，因此进一步是**多变量回归问题** (注：单变量回归问题是给定数据只有一个特征)

因为没有连续的数据流输入到系统，不需要随着数据改变而调整，因此是普通的batch learning。


## 度量方法选择

对于 回归问题 典型的性能度量是均方根误差(Root Mean Square Error, RMSE)， 用于度量系统在预测中的误差的标准偏差。

计算RMSE的数学公式如下：

$$RMSE(X, h) = \sqrt{\frac{1}{m} \sum_{i=1}^{m}(h(x^{(i)}) - y^{(i)})^2}$$

> 该公式中一些记号说明:
>
> **m**: 数据集中实例个数。例如，对2000个街区群的验证集进行RMSE估计，则m=2000
>
> **$$x^{(i)}$$**: 数据集中第i个实例的所有特征值向量，
>
> **$$y^{(i)}$$**: 表示第i个实例对应的标签
>
> **X**: 数据集中所有实例的所有特征值的矩阵。
> **h**: 系统预测函数，也称hypothesis
>
> RMSE(X,h): 损失函数

还有其他的一些度量方法，像均值绝对误差(Mean Absolute Error, MAE), 计算公式如下：

$$
MAE(X,h) = \frac{1}{m}\sum_{i=1}^{m}|h(x^{(i)}) - y^{(i)}|
$$

RMSE和MAE之间的比较:

都是用来测试两个向量(预测的向量和目标值向量)之间的距离

- RMSE的计算对应与欧几里德范数，称之为$$\ell_2$$范数，记为: $${\|.\|_2}$$


- MAE的计算对应于Manhattan范数， 称之为$$\ell_1$$范数， 记为: $${\|.\|}_1$$


- 更到的向量v的$$\ell_k$$范数(包含n个元素),定义为:

$${\|v\|}_{k}={({|v_0|}^k + {|v_1|}^k + ... +{|v_n|}^k)}^{\frac{1}{k}} \ell_0$$


# 获取数据

## 创建工作环境

- 安装python

- 安装python模块， Jupyter， Numpy， Pandas，Matplotlib和Scikit-Learn


## 下载数据

典型的数据存储环境是关系型数据库中，涉及到多个表/文件/文件夹。本例中简化处理，数据存储在单个压缩文件housing.tgz中，其中包含一个CSV文件——housing.csv，包含所有数据

以下通过python程序下载压缩文件并提取其中内存


# 准备数据用于机器学习算法


# 选择和训练模型

# 微调模型

# 启动，监测和维护系统
